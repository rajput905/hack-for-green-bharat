<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GreenFlow AI â€“ Real-Time Environmental Monitoring</title>
  <meta name="description"
    content="GreenFlow AI provides real-time CO2 monitoring, risk assessment, and AI-powered environmental recommendations for India's green future." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOP NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header class="navbar" role="banner">
    <div class="navbar__brand">
      <span class="navbar__logo" aria-hidden="true">ğŸŒ¿</span>
      <span class="navbar__title">GreenFlow <strong>AI</strong></span>
    </div>

    <!-- City Mode Dropdown -->
    <div class="city-selector">
      <label for="city-select" class="city-label">ğŸ™ City:</label>
      <select id="city-select" class="city-select" aria-label="Select city">
        <option value="Delhi">Delhi</option>
        <option value="Mumbai">Mumbai</option>
        <option value="Bangalore">Bangalore</option>
        <option value="Chennai">Chennai</option>
        <option value="Industrial Zone">Industrial Zone</option>
      </select>
    </div>

    <nav class="navbar__links" aria-label="Primary navigation">
      <a href="#dashboard">Dashboard</a>
      <a href="#simulator">Simulator</a>
      <a href="#ai-chat">AI Advisor</a>
      <a href="#alerts">Alerts</a>
      <button class="arch-btn" id="arch-modal-btn" title="How GreenFlow Works">âš™ Architecture</button>
    </nav>
    <div class="navbar__status">
      <span id="connection-indicator" class="status-dot status-dot--connecting" aria-label="Connection status"></span>
      <span id="connection-label">Connectingâ€¦</span>
    </div>
  </header>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="hero" aria-label="Dashboard hero" id="dashboard">
    <div class="hero__text">
      <p class="hero__eyebrow">ğŸ‡®ğŸ‡³ Hack for Green Bharat</p>
      <h1 class="hero__title">Real-Time COâ‚‚ Intelligence</h1>
      <p class="hero__subtitle">
        Continuous environmental monitoring, risk scoring, and AI-powered
        recommendations â€” all in one live dashboard.
      </p>
    </div>
    <div class="hero__time" id="live-clock" aria-live="polite"></div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SYSTEM STATUS PANEL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="status-panel-wrapper">
    <div class="status-panel" id="system-status-panel">
      <div class="status-item">
        <span class="status-item__dot" id="sp-api-dot"></span>
        <span>API</span>
        <strong id="sp-api-label">Checkingâ€¦</strong>
      </div>
      <div class="status-item">
        <span class="status-item__dot" id="sp-ai-dot"></span>
        <span>AI Engine</span>
        <strong id="sp-ai-label">Checkingâ€¦</strong>
      </div>
      <div class="status-item">
        <span class="status-item__dot" id="sp-stream-dot"></span>
        <span>Stream</span>
        <strong id="sp-stream-label">Waitingâ€¦</strong>
      </div>
      <div class="status-item">
        <span>Last Update</span>
        <strong id="sp-last-update">â€”</strong>
      </div>
      <div class="status-item">
        <span>City</span>
        <strong id="sp-city">Delhi</strong>
      </div>
    </div>
  </div>

  <main class="container" id="main-content">

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• METRIC CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="metrics-grid" aria-label="Key metrics">

      <article class="metric-card" id="card-co2">
        <div class="metric-card__icon" aria-hidden="true">ğŸŒ«ï¸</div>
        <div class="metric-card__label">COâ‚‚ Level</div>
        <div class="metric-card__value" id="co2-value">â€”</div>
        <div class="metric-card__unit">ppm</div>
        <div class="metric-card__trend" id="co2-trend"></div>
        <!-- Anomaly Badge -->
        <div class="anomaly-badge" id="anomaly-badge" style="display:none">âš  Spike Detected</div>
      </article>

      <article class="metric-card" id="card-risk">
        <div class="metric-card__icon" aria-hidden="true">âš ï¸</div>
        <div class="metric-card__label">
          Risk Score
          <span class="tooltip-icon" data-tip="risk">â„¹</span>
        </div>
        <div class="metric-card__value" id="risk-value">â€”</div>
        <div class="metric-card__unit">
          / 1.0 &nbsp; <span class="risk-badge" id="risk-category-badge">â€”</span>
        </div>
        <div class="risk-bar-wrapper">
          <div class="risk-bar" id="risk-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0"
            aria-valuemax="100"></div>
        </div>
        <div class="tooltip-box" id="tooltip-risk">
          Calculated as <code>min(COâ‚‚ / 500, 1.0)</code>.<br>
          Safe &lt; 0.7 Â· Warning â‰¥ 0.7 Â· Danger â‰¥ 0.8 Â· Critical â‰¥ 1.0
        </div>
      </article>

      <article class="metric-card" id="card-severity">
        <div class="metric-card__icon" aria-hidden="true">ğŸ“Š</div>
        <div class="metric-card__label">
          Severity
          <span class="tooltip-icon" data-tip="severity">â„¹</span>
        </div>
        <div class="metric-card__value severity-badge" id="severity-value">â€”</div>
        <div class="metric-card__unit" id="severity-source">â€”</div>
        <div class="tooltip-box" id="tooltip-severity">
          <b>Safe</b>: COâ‚‚ &lt; 350 ppm (CPCB standard)<br>
          <b>Warning</b>: 350â€“400 ppm (elevated)<br>
          <b>Danger</b>: 400â€“450 ppm (regulatory limit)<br>
          <b>Critical</b>: &gt; 450 ppm (emergency)
        </div>
      </article>

      <article class="metric-card" id="card-compliance">
        <div class="metric-card__icon" aria-hidden="true">ğŸ“</div>
        <div class="metric-card__label">Compliance</div>
        <div class="metric-card__value" id="compliance-value">â€”</div>
        <div class="metric-card__unit">vs 400 ppm limit</div>
        <div class="compliance-bar-wrapper">
          <div class="compliance-bar" id="compliance-bar"></div>
          <div class="compliance-limit-marker"></div>
        </div>
        <div class="compliance-label" id="compliance-label">Loadingâ€¦</div>
      </article>

    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COâ‚‚ CHART â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="chart-section" aria-label="COâ‚‚ trend chart">
      <h2 class="section-title">COâ‚‚ Trend <span class="live-badge">LIVE</span></h2>
      <div class="chart-wrapper">
        <canvas id="co2-chart" aria-label="COâ‚‚ concentration over time"></canvas>
      </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PREDICTION + RECOMMENDATION â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="twin-grid">

      <section class="panel" aria-label="24-hour prediction">
        <h2 class="panel__title">ğŸ“ˆ COâ‚‚ Forecast</h2>
        <div class="panel__body" id="prediction-panel">
          <div class="forecast-row">
            <span>Current</span>
            <strong id="pred-current">â€”</strong>
          </div>
          <div class="forecast-row">
            <span>In 1 Hour</span>
            <strong id="pred-1h">â€”</strong>
          </div>
          <div class="forecast-row">
            <span>In 24 Hours</span>
            <strong id="pred-24h">â€”</strong>
          </div>
          <div class="forecast-row">
            <span>Trend</span>
            <strong id="pred-trend">â€”</strong>
          </div>
          <div class="forecast-row">
            <span>Confidence</span>
            <strong id="pred-confidence">â€”</strong>
          </div>
          <!-- Confidence bar -->
          <div class="confidence-bar-wrapper" title="Model confidence level">
            <div class="confidence-bar" id="confidence-bar"></div>
          </div>
        </div>
      </section>

      <section class="panel" aria-label="AI recommendation">
        <h2 class="panel__title">ğŸ¤– AI Recommendation</h2>
        <div class="panel__body" id="recommendation-panel">
          <div class="rec-skeleton" id="rec-skeleton">
            <div class="skeleton-line"></div>
            <div class="skeleton-line skeleton-line--short"></div>
            <div class="skeleton-line"></div>
          </div>
          <p class="rec-title" id="rec-title" style="display:none">Loadingâ€¦</p>
          <p class="rec-body" id="rec-body"></p>
          <ul class="rec-actions" id="rec-actions"></ul>
          <div class="rec-urgency" id="rec-urgency"></div>
          <!-- Why this recommendation button -->
          <button class="why-btn" id="why-rec-btn" style="display:none">ğŸ” Why this recommendation?</button>
          <div class="why-panel" id="why-panel" style="display:none">
            <div class="why-row"><span>COâ‚‚ Level</span><strong id="why-co2">â€”</strong></div>
            <div class="why-row"><span>Risk Score</span><strong id="why-risk">â€”</strong></div>
            <div class="why-row"><span>Forecast (1h)</span><strong id="why-forecast">â€”</strong></div>
            <div class="why-row"><span>Severity</span><strong id="why-severity">â€”</strong></div>
            <div class="why-row"><span>Retrieved Context</span><strong>Environmental knowledge base (ChromaDB
                RAG)</strong></div>
          </div>
        </div>
      </section>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WHAT-IF SIMULATOR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="simulator-section" id="simulator" aria-label="What-If Simulator">
      <h2 class="section-title">ğŸ§ª What-If Simulator
        <span class="section-subtitle">â€” Test any COâ‚‚ scenario instantly</span>
      </h2>
      <div class="simulator-grid">
        <div class="sim-input-group">
          <label for="sim-co2">COâ‚‚ Level (ppm)</label>
          <input type="number" id="sim-co2" class="sim-input" value="420" min="300" max="1000" step="1" />
        </div>
        <div class="sim-input-group">
          <label for="sim-temp">Temperature (Â°C)</label>
          <input type="number" id="sim-temp" class="sim-input" value="28" min="-10" max="60" step="0.5" />
        </div>
        <div class="sim-input-group">
          <label for="sim-aqi">AQI</label>
          <input type="number" id="sim-aqi" class="sim-input" value="120" min="0" max="500" step="1" />
        </div>
        <button class="sim-btn" id="sim-run-btn">â–¶ Simulate</button>
      </div>
      <div class="sim-result" id="sim-result" style="display:none">
        <div class="sim-output-grid">
          <div class="sim-output-card">
            <div class="sim-output-label">Risk Score</div>
            <div class="sim-output-value" id="sim-risk">â€”</div>
          </div>
          <div class="sim-output-card">
            <div class="sim-output-label">Category</div>
            <div class="sim-output-value" id="sim-category">â€”</div>
          </div>
          <div class="sim-output-card">
            <div class="sim-output-label">Compliance</div>
            <div class="sim-output-value" id="sim-compliance">â€”</div>
          </div>
        </div>
        <div class="sim-recommendation" id="sim-recommendation"></div>
      </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AI CHAT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="chat-section" id="ai-chat" aria-label="AI chat advisor">
      <h2 class="section-title">ğŸ’¬ Ask GreenFlow AI</h2>
      <div class="chat-window" id="chat-window" aria-live="polite" aria-label="Chat messages">
        <div class="chat-message chat-message--bot">
          <p>ğŸ‘‹ Hi! I'm GreenFlow AI. Ask me about COâ‚‚ levels, climate risk, or environmental actions.</p>
        </div>
      </div>
      <!-- Loading shimmer -->
      <div class="chat-skeleton" id="chat-skeleton" style="display:none">
        <div class="chat-skeleton__dot"></div>
        <div class="chat-skeleton__text">Analyzing environmental riskâ€¦</div>
      </div>
      <form class="chat-form" id="chat-form" aria-label="Ask a question">
        <input type="text" id="chat-input" class="chat-input" placeholder="e.g. What actions reduce COâ‚‚ in Delhi?"
          autocomplete="off" aria-label="Your question" maxlength="500" />
        <button type="submit" class="chat-submit" id="chat-submit-btn" aria-label="Send question">
          Send
        </button>
      </form>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• RECENT EVENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="events-section" aria-label="Recent sensor events">
      <h2 class="section-title">ğŸ“¡ Recent Events</h2>
      <div class="table-wrapper">
        <table class="events-table" aria-label="Environmental events">
          <thead>
            <tr>
              <th scope="col">Time</th>
              <th scope="col">Source</th>
              <th scope="col">COâ‚‚ (ppm)</th>
              <th scope="col">Risk</th>
              <th scope="col">Severity</th>
            </tr>
          </thead>
          <tbody id="events-table-body">
            <tr>
              <td colspan="5" class="table-placeholder">Loading eventsâ€¦</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ALERT HISTORY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="alerts-section" id="alerts" aria-label="Alert history">
      <h2 class="section-title">ğŸš¨ Alert History</h2>
      <div id="alerts-container" class="alerts-list">
        <p class="no-alerts">No active alerts.</p>
      </div>
    </section>

  </main>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <footer class="footer" role="contentinfo">
    <div class="footer__inner">
      <span>ğŸŒ¿ GreenFlow AI Â© 2025 â€“ Hack for Green Bharat</span>
      <span>FastAPI Â· OpenAI Â· ChromaDB Â· SSE Â· Real-Time Intelligence</span>
    </div>
  </footer>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ARCHITECTURE MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="arch-modal" role="dialog" aria-modal="true" aria-label="System Architecture"
    style="display:none">
    <div class="modal">
      <button class="modal__close" id="arch-modal-close" aria-label="Close">âœ•</button>
      <h2 class="modal__title">âš™ How GreenFlow AI Works</h2>
      <pre class="arch-diagram">
  Sensor Input
      â”‚
      â–¼
  POST /api/v1/events
      â”‚
      â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚       Feature Extractor         â”‚
  â”‚  risk_score = COâ‚‚ / 500        â”‚
  â”‚  carbon_score = delta baseline  â”‚
  â”‚  classify_severity()            â”‚
  â”‚  is_anomaly() â†’ z-score         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                 â–¼
  SQLite / PostgreSQL   AlertService
  (async ORM)          (threshold check)
        â”‚
        â–¼
  JSONL Pipeline
        â”‚
        â–¼
  SSE Generator â”€â”€â”€â”€â”€â”€â–º Browser Dashboard
                              (every 2s)

  On /query request:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    RAG Engine       â”‚
  â”‚  ChromaDB search    â”‚
  â”‚  + live COâ‚‚ context â”‚
  â”‚  â†’ OpenAI GPT-3.5   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      </pre>
      <div class="modal__footer">
        Risk formula: <code>risk = min(COâ‚‚_ppm / 500, 1.0)</code> &nbsp;|&nbsp;
        Thresholds: Safe &lt;350 Â· Warning â‰¥350 Â· Danger â‰¥400 Â· Critical â‰¥450
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="js/api.js"></script>
  <script src="js/charts.js"></script>
  <script src="js/app.js"></script>

</body>

</html>